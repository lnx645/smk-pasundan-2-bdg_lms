import{m as L,u as N,c as A,w as D,r as _,b as i,o as n,e as t,d as p,L as S,g as c,i as s,O as v,P as U,f as F,k as m,n as T,t as u,h as r,z as k,v as x,J as R,F as V,j as E,Q as b,s as C,C as w}from"./app-6R2423CB.js";import{_ as G}from"./breadcrumb.vue_vue_type_script_setup_true_lang-DduX5xEt.js";import{A as z}from"./arrow-left-J-lF9cgP.js";import{C as J}from"./camera-DUYlcWEg.js";import{R as X}from"./refresh-cw-DUFVpadF.js";import{S as H}from"./save-BklBu0eK.js";const $={class:"mb-6 flex flex-col gap-4 px-1 sm:flex-row sm:items-center sm:justify-between"},O={class:"px-4 pb-10"},Q={class:"w-full lg:w-1/4"},q={class:"sticky top-6 flex flex-col items-center rounded-xl border border-neutral-200 bg-white p-6 text-center shadow-sm"},W=["src"],Y=["src"],Z={key:2,class:"flex h-full w-full flex-col items-center justify-center bg-neutral-50 text-neutral-400 group-hover:text-indigo-500"},ee={key:0,class:"mt-2 text-xs text-red-500"},te={class:"flex-1"},se={class:"rounded-xl border border-neutral-200 bg-white shadow-sm"},oe={class:"p-6"},le={class:"grid grid-cols-1 gap-5 md:grid-cols-2"},ne={class:"col-span-1 md:col-span-2"},ae={key:0,class:"text-xs text-red-500"},ie={key:0,class:"text-xs text-red-500"},re={class:"col-span-1 grid grid-cols-1 gap-4 md:col-span-2 md:grid-cols-3"},de=["disabled"],ue=["value"],pe={key:0,class:"mt-1 text-[10px] text-amber-600"},me={key:1,class:"text-xs text-red-500"},ge={class:"col-span-1 md:col-span-2"},xe={class:"flex flex-wrap items-center gap-6 pt-1"},be={class:"flex cursor-pointer items-center gap-2 text-sm text-neutral-600 transition hover:text-indigo-600"},fe={class:"flex cursor-pointer items-center gap-2 text-sm text-neutral-600 transition hover:text-indigo-600"},ce={class:"flex cursor-pointer items-center gap-2 text-sm text-neutral-600 transition hover:text-indigo-600"},ve={class:"flex cursor-pointer items-center gap-2 text-sm text-neutral-600 transition hover:text-indigo-600"},ke={class:"flex items-center justify-end gap-3 rounded-b-xl border-t border-neutral-100 bg-neutral-50 px-6 py-4"},we=["disabled"],ye={key:2},he={key:3},je=L({__name:"edit",props:{kelasList:{},siswa:{}},setup(K){const a=K,j=[{label:"Dashboard"},{label:"User Management"},{label:"Siswa"},{label:"Edit"}],o=N({name:a.siswa.user?.name||a.siswa.name||"",nis:a.siswa.nis,jenis_kelamin:a.siswa.jenis_kelamin,agama:a.siswa.agama,tahun_masuk:a.siswa.tahun_masuk,tingkat:a.siswa.tingkat,kelas_id:a.siswa.kelas_id,status:a.siswa.status,pas_photo:null}),f=A(()=>a.kelasList.filter(d=>d.tingkat==o.tingkat));D(()=>o.tingkat,(d,e)=>{e!==void 0&&d!=a.siswa.tingkat&&(o.kelas_id="")});const g=_(null),y=_(null),M=d=>{const e=d.target;if(e.files&&e.files[0]){const l=e.files[0];if(l.size>2048*1024){w.error("Ukuran file terlalu besar (Max 2MB)");return}o.pas_photo=l;const h=new FileReader;h.onload=B=>{g.value=B.target?.result},h.readAsDataURL(l)}},P=()=>{y.value?.click()},I=()=>{o.post(v.updateSiswa({id:a.siswa.nis}).url,{preserveScroll:!0,onSuccess:()=>{w.success("Data siswa berhasil diperbarui!",{position:"top-center"}),o.pas_photo=null,g.value=null},onError:d=>{w.error("Gagal memperbarui data. Periksa inputan Anda.",{position:"top-center"}),console.error(d)}})};return(d,e)=>(n(),i(V,null,[t("div",$,[p(G,{items:j}),p(s(U),{href:s(v).siswa().url,class:"inline-flex items-center justify-center gap-2 rounded-lg border border-neutral-300 bg-white px-4 py-2 text-sm font-medium text-neutral-700 shadow-sm hover:bg-neutral-50"},{default:S(()=>[p(s(z),{class:"h-4 w-4"}),e[11]||(e[11]=c(" Kembali ",-1))]),_:1,__:[11]},8,["href"])]),t("div",O,[t("form",{onSubmit:F(I,["prevent"]),class:"flex flex-col gap-6 lg:flex-row"},[t("div",Q,[t("div",q,[e[14]||(e[14]=t("h3",{class:"mb-4 text-sm font-semibold text-neutral-700"},"Foto Profil",-1)),t("div",{class:T(["group relative h-32 w-32 cursor-pointer overflow-hidden rounded-full border-2 transition-colors",s(o).errors.pas_photo?"border-red-500":"border-dashed border-neutral-300 hover:border-indigo-500"]),onClick:P},[g.value?(n(),i("img",{key:0,src:g.value,class:"h-full w-full object-cover"},null,8,W)):a.siswa.pas_photo?(n(),i("img",{key:1,src:`/storage/${a.siswa.pas_photo}`,class:"h-full w-full object-cover"},null,8,Y)):(n(),i("div",Z,[p(s(J),{class:"mb-1 h-8 w-8"}),e[12]||(e[12]=t("span",{class:"text-[10px]"},"Upload",-1))])),e[13]||(e[13]=t("div",{class:"absolute inset-0 flex items-center justify-center bg-black/40 opacity-0 transition-opacity group-hover:opacity-100"},[t("span",{class:"text-xs font-medium text-white"},"Ganti")],-1))],2),t("input",{ref_key:"fileInput",ref:y,type:"file",accept:"image/*",class:"hidden",onChange:M},null,544),e[15]||(e[15]=t("p",{class:"mt-4 text-[10px] text-neutral-400"},"Format: JPG, PNG. Maks 2MB.",-1)),s(o).errors.pas_photo?(n(),i("div",ee,u(s(o).errors.pas_photo),1)):m("",!0)])]),t("div",te,[t("div",se,[e[33]||(e[33]=t("div",{class:"border-b border-neutral-100 px-6 py-4"},[t("h2",{class:"text-base font-semibold text-neutral-800"},"Edit Informasi Siswa"),t("p",{class:"text-xs text-neutral-500"},"Perbarui data diri siswa & akun pengguna.")],-1)),t("div",oe,[t("div",le,[t("div",ne,[e[16]||(e[16]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},"Nama Lengkap",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s(o).name=l),type:"text",class:"w-full rounded-lg border border-neutral-200 bg-neutral-50 px-3 py-2 text-sm transition-all outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100",placeholder:"Contoh: Dimas Aditya"},null,512),[[k,s(o).name]]),s(o).errors.name?(n(),i("span",ae,u(s(o).errors.name),1)):m("",!0)]),t("div",null,[e[17]||(e[17]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},[c("NIS"),t("sup",{class:"text-red-500"},"*")],-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s(o).nis=l),type:"number",class:"w-full rounded-lg border border-neutral-200 px-3 py-2 text-sm transition-all outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100 disabled:bg-gray-100 disabled:text-gray-500",placeholder:"Nomor Induk Siswa"},null,512),[[k,s(o).nis]]),s(o).errors.nis?(n(),i("span",ie,u(s(o).errors.nis),1)):m("",!0)]),t("div",null,[e[19]||(e[19]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},"Jenis Kelamin",-1)),r(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>s(o).jenis_kelamin=l),class:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100"},e[18]||(e[18]=[t("option",{value:"L"},"Laki-laki",-1),t("option",{value:"P"},"Perempuan",-1)]),512),[[x,s(o).jenis_kelamin]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},"Agama",-1)),r(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>s(o).agama=l),class:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100"},e[20]||(e[20]=[R('<option value="Islam">Islam</option><option value="Kristen">Kristen</option><option value="Katolik">Katolik</option><option value="Hindu">Hindu</option><option value="Buddha">Buddha</option><option value="Konghucu">Konghucu</option>',6)]),512),[[x,s(o).agama]])]),t("div",re,[t("div",null,[e[22]||(e[22]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},"Tahun Masuk",-1)),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s(o).tahun_masuk=l),type:"number",class:"w-full rounded-lg border border-neutral-200 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100"},null,512),[[k,s(o).tahun_masuk]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},"Tingkat",-1)),r(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>s(o).tingkat=l),class:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100"},e[23]||(e[23]=[t("option",{value:"10"},"X (Sepuluh)",-1),t("option",{value:"11"},"XI (Sebelas)",-1),t("option",{value:"12"},"XII (Dua Belas)",-1)]),512),[[x,s(o).tingkat]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},"Kelas",-1)),r(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>s(o).kelas_id=l),disabled:f.value.length===0,class:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100 disabled:bg-neutral-100 disabled:text-neutral-400"},[e[25]||(e[25]=t("option",{value:"",disabled:""},"Pilih Kelas",-1)),(n(!0),i(V,null,E(f.value,l=>(n(),i("option",{key:l.id,value:l.id},u(l.nama),9,ue))),128))],8,de),[[x,s(o).kelas_id]]),f.value.length===0?(n(),i("div",pe," *Tidak ada kelas untuk tingkat "+u(s(o).tingkat),1)):m("",!0),s(o).errors.kelas_id?(n(),i("span",me,u(s(o).errors.kelas_id),1)):m("",!0)])]),t("div",ge,[e[31]||(e[31]=t("label",{class:"mb-1.5 block text-xs font-medium text-neutral-700"},"Status Siswa",-1)),t("div",xe,[t("label",be,[r(t("input",{type:"radio","onUpdate:modelValue":e[7]||(e[7]=l=>s(o).status=l),value:"aktif",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[b,s(o).status]]),e[27]||(e[27]=t("span",{class:"font-medium"},"Aktif",-1))]),t("label",fe,[r(t("input",{type:"radio","onUpdate:modelValue":e[8]||(e[8]=l=>s(o).status=l),value:"lulus",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[b,s(o).status]]),e[28]||(e[28]=t("span",{class:"font-medium"},"Lulus",-1))]),t("label",ce,[r(t("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=l=>s(o).status=l),value:"keluar",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[b,s(o).status]]),e[29]||(e[29]=t("span",{class:"font-medium"},"Keluar",-1))]),t("label",ve,[r(t("input",{type:"radio","onUpdate:modelValue":e[10]||(e[10]=l=>s(o).status=l),value:"tinggal_kelas",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[b,s(o).status]]),e[30]||(e[30]=t("span",{class:"font-medium"},"Tinggal Kelas",-1))])])])])]),t("div",ke,[p(s(U),{href:s(v).siswa().url,class:"rounded-lg border border-neutral-200 bg-white px-4 py-2 text-sm font-medium text-neutral-600 transition hover:bg-neutral-100 active:scale-95"},{default:S(()=>e[32]||(e[32]=[c(" Batal ",-1)])),_:1,__:[32]},8,["href"]),t("button",{type:"submit",disabled:s(o).processing,class:"flex items-center gap-2 rounded-lg bg-indigo-600 px-6 py-2 text-sm font-medium text-white transition hover:bg-indigo-700 hover:shadow-lg hover:shadow-indigo-500/30 active:scale-95 disabled:opacity-50"},[s(o).processing?(n(),C(s(X),{key:0,class:"h-4 w-4 animate-spin"})):(n(),C(s(H),{key:1,class:"h-4 w-4"})),s(o).processing?(n(),i("span",ye,"Menyimpan...")):(n(),i("span",he,"Simpan Perubahan"))],8,we)])])])],32)])],64))}});export{je as default};
