import{m as P,p as B,r as S,u as j,w as f,a3 as c,ak as v,C as y,c as E,al as w,a9 as L,b as l,o as i,e as a,d,i as t,L as g,g as b,k as m,n as _,t as n,h as M,z as U,f as z}from"./app-6R2423CB.js";import{u as F}from"./TugasController-DhFk6SCa.js";import{_ as h}from"./button.vue_vue_type_script_setup_true_lang-Dz5dKsO2.js";import{_ as K}from"./page-title.vue_vue_type_script_setup_true_lang-By9Ku7yv.js";import{A as $,a as A,b as D,B as G,c as H,C as N,d as J,e as Q,E as R,f as O,S as W,H as q,I as X,g as Y,h as Z,i as ee,j as se,k as te,l as ae,m as oe,n as re,o as le,p as ie,q as ne,r as de,L as ue,s as pe,t as me,u as ce,M as ge,v as be,P as _e,w as xe,x as fe,T as ve,y as ke,z as ye,D as we,F as he,G as Ce,J as Ve,K as Ie,U as Te,N as Pe,O as Be,Q as Se,R as je,V as Ee,W as Le,X as Me,Y as Ue,Z as ze,_ as Fe,a1 as Ke,$ as $e,a0 as Ae}from"./ckeditor5-BztYqWsi.js";import{l as De}from"./lodash-CvLQx7ah.js";import{C as x}from"./vue-select.es-6d7oZifc.js";const Ge={class:"mx-auto max-w-7xl pb-20"},He={class:"mb-4 flex flex-col justify-between gap-4 md:flex-row md:items-center"},Ne={class:"flex items-center gap-3"},Je={key:0,class:"flex items-center gap-2"},Qe={key:1},Re={class:"space-y-6 lg:col-span-1"},Oe={class:"rounded-xl border border-neutral-200 bg-white shadow-sm"},We={class:"space-y-5 p-5"},qe={key:0,class:"mt-1 text-xs font-medium text-red-500"},Xe={class:"mb-3 grid grid-cols-2 rounded-lg bg-neutral-100 p-1"},Ye={key:0},Ze={key:1},es={class:"flex flex-col py-1"},ss={class:"text-sm font-bold text-neutral-800"},ts={class:"text-xs text-neutral-500"},as={key:2,class:"mt-1 text-xs font-medium text-red-500"},os={class:"rounded-xl border border-neutral-200 bg-white shadow-sm"},rs={class:"space-y-5 p-5"},ls={key:0,class:"mt-1 text-xs font-medium text-red-500"},is={key:0,class:"mt-1 text-xs font-medium text-red-500"},ns={class:"space-y-4 lg:col-span-2"},ds={class:"rounded-xl border border-neutral-200 bg-white p-6 shadow-sm"},us={class:"mb-6"},ps={key:0,class:"mt-2 text-sm font-medium text-red-500"},ms={class:"relative"},cs={key:0,class:"mt-1 text-xs font-medium text-red-500"},ws=P({__name:"edit-tugas",setup(gs){const u=B().props,C=["file","text","foto"],p=S([]),e=j({matpel:u.tugas.matpel_kode,judul:u.tugas.title,deskripsi:u.tugas.content,mode_pengumpulan:u.tugas.mode_pengumpulan,deadline:u.tugas.deadline,receiver_type:u.tugas.receiver_type,receiver_type_id:u.tugas.receiver_type_id??[]});f(()=>e.matpel,async(r,s)=>{if(r&&s!==void 0){const o=await c.post(v().url,{matpel_kode:r});p.value=o.data??[],e.receiver_type==="class_id"&&(e.receiver_type_id=[])}}),f(()=>e.receiver_type,(r,s)=>{s!==void 0&&(p.value=[],e.receiver_type_id=[],r==="class_id"&&e.matpel&&c.post(v().url,{matpel_kode:e.matpel}).then(o=>p.value=o.data??[]))}),f(()=>[e.hasErrors,e.processing],()=>{e.hasErrors&&!e.errors.success&&!e.processing?y.error("Gagal! Mohon periksa kembali inputan Anda."):e.errors.success&&y.success(e.errors.success)});const V=E(()=>({licenseKey:"GPL",height:500,placeholder:"Tulis instruksi tugas...",plugins:[$,A,D,G,H,N,J,Q,R,O,W,q,X,Y,Z,ee,se,te,ae,oe,re,le,ie,ne,de,ue,pe,me,ce,ge,be,_e,xe,fe,ve,ke,ye,we,he,Ce,Ve,Ie,Te,Pe,Be,Se,je,Ee,Le,Me,Ue,ze,Fe],toolbar:["heading","|","bold","italic","underline","strikethrough","code","|","bulletedList","numberedList","todoList","|","fontSize","fontColor","fontBackgroundColor","|","link","insertImage","insertTable","blockQuote","codeBlock","|","undo","redo"]})),I=De.debounce(async(r,s)=>{if(!r){s(!1);return}s(!0);try{const{data:o}=await c.get(w().url,{params:{keywords:r}});p.value=o}catch(o){console.error("Gagal mencari siswa:",o)}finally{s(!1)}},500);function T(){window.history.back()}async function k(){e.put(F({id:u.tugas.tugasID}).url,{onSuccess:()=>{}})}return L(async()=>{if(e.receiver_type==="class_id"&&e.matpel){const r=await c.post(v().url,{matpel_kode:e.matpel});p.value=r.data}if(e.receiver_type==="siswa_id"&&e.receiver_type_id.length>0)try{const{data:r}=await c.get(w().url,{params:{ids:e.receiver_type_id}});p.value=r}catch(r){console.error("Gagal load data siswa selected",r)}}),(r,s)=>(i(),l("div",Ge,[a("div",He,[d(K,{title:"Edit Tugas",subtitle:`Perbarui detail tugas: ${t(e).judul}`},null,8,["subtitle"]),a("div",Ne,[d(h,{onClick:T,variant:"secondary",class:"border border-neutral-300 bg-white text-neutral-600 shadow-sm hover:bg-neutral-50"},{default:g(()=>s[9]||(s[9]=[b(" Batal ",-1)])),_:1,__:[9]}),d(h,{onClick:k,disabled:t(e).processing,class:"shadow-md shadow-blue-500/20"},{default:g(()=>[t(e).processing?(i(),l("span",Je,s[10]||(s[10]=[a("svg",{class:"h-4 w-4 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),b(" Simpan Perubahan ",-1)]))):(i(),l("span",Qe,"Simpan Perubahan"))]),_:1},8,["disabled"])])]),a("form",{onSubmit:z(k,["prevent"]),class:"grid grid-cols-1 items-start gap-6 lg:grid-cols-3"},[a("div",Re,[a("div",Oe,[s[15]||(s[15]=a("div",{class:"flex items-center justify-between border-b border-neutral-100 bg-neutral-50 px-5 py-3"},[a("h3",{class:"text-sm font-semibold text-neutral-700"},"Target & Mata Pelajaran")],-1)),a("div",We,[a("div",null,[s[11]||(s[11]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Mata Pelajaran",-1)),d(t(x),{placeholder:"Pilih Mapel...",options:r.$page.props.matpels,label:"nama",reduce:o=>o.kode_matpel,modelValue:t(e).matpel,"onUpdate:modelValue":s[0]||(s[0]=o=>t(e).matpel=o),class:_(["v-select-custom",{"rounded-lg border-red-500 ring-1 ring-red-500":t(e).errors.matpel}])},null,8,["options","reduce","modelValue","class"]),t(e).errors.matpel?(i(),l("p",qe,n(t(e).errors.matpel),1)):m("",!0)]),s[14]||(s[14]=a("hr",{class:"border-dashed border-neutral-200"},null,-1)),a("div",null,[s[13]||(s[13]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Tugaskan Kepada",-1)),a("div",Xe,[a("button",{type:"button",onClick:s[1]||(s[1]=o=>t(e).receiver_type="class_id"),class:_(["rounded-md py-1.5 text-sm font-medium transition-all duration-200",t(e).receiver_type==="class_id"?"bg-white text-blue-600 shadow-sm":"text-neutral-500 hover:text-neutral-700"])}," Per Kelas ",2),a("button",{type:"button",onClick:s[2]||(s[2]=o=>t(e).receiver_type="siswa_id"),class:_(["rounded-md py-1.5 text-sm font-medium transition-all duration-200",t(e).receiver_type==="siswa_id"?"bg-white text-blue-600 shadow-sm":"text-neutral-500 hover:text-neutral-700"])}," Per Siswa ",2)]),t(e).receiver_type=="class_id"?(i(),l("div",Ye,[d(t(x),{placeholder:"Pilih Kelas...",options:p.value,label:"nama_kelas",reduce:o=>o.id_kelas,multiple:!0,modelValue:t(e).receiver_type_id,"onUpdate:modelValue":s[3]||(s[3]=o=>t(e).receiver_type_id=o),class:"v-select-custom"},null,8,["options","reduce","modelValue"])])):(i(),l("div",Ze,[d(t(x),{onSearch:t(I),placeholder:"Ketik nama siswa...",options:p.value,reduce:o=>o?.user?.id,multiple:!0,modelValue:t(e).receiver_type_id,"onUpdate:modelValue":s[4]||(s[4]=o=>t(e).receiver_type_id=o),class:"v-select-custom"},{"no-options":g(()=>s[12]||(s[12]=[b("Ketik untuk mencari...",-1)])),option:g(o=>[a("div",es,[a("span",ss,n(o.user?.name),1),a("span",ts,n(o.kelas?.nama)+" â€¢ "+n(o?.nis),1)])]),"selected-option":g(o=>[b(n(o.user?.name),1)]),_:1},8,["onSearch","options","reduce","modelValue"])])),t(e).errors.receiver_type_id?(i(),l("p",as,n(t(e).errors.receiver_type_id),1)):m("",!0)])])]),a("div",os,[s[18]||(s[18]=a("div",{class:"border-b border-neutral-100 bg-neutral-50 px-5 py-3"},[a("h3",{class:"text-sm font-semibold text-neutral-700"},"Pengumpulan")],-1)),a("div",rs,[a("div",null,[s[16]||(s[16]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Batas Waktu (Deadline)",-1)),d(t(Ke),{modelValue:t(e).deadline,"onUpdate:modelValue":s[5]||(s[5]=o=>t(e).deadline=o),"auto-apply":"","enable-time-picker":!0,"input-class-name":"dp-custom-input"},null,8,["modelValue"]),t(e).errors.deadline?(i(),l("p",ls,n(t(e).errors.deadline),1)):m("",!0)]),a("div",null,[s[17]||(s[17]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Format Jawaban",-1)),d(t(x),{class:"v-select-custom",modelValue:t(e).mode_pengumpulan,"onUpdate:modelValue":s[6]||(s[6]=o=>t(e).mode_pengumpulan=o),placeholder:"Pilih Format...",options:C},null,8,["modelValue"]),t(e).errors.mode_pengumpulan?(i(),l("p",is,n(t(e).errors.mode_pengumpulan),1)):m("",!0)])])])]),a("div",ns,[a("div",ds,[a("div",us,[M(a("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=o=>t(e).judul=o),placeholder:"Tulis Judul Tugas di sini...",class:"w-full border-none p-0 text-2xl font-bold text-neutral-800 placeholder-neutral-300 transition-all focus:ring-0 focus:outline-none"},null,512),[[U,t(e).judul]]),s[19]||(s[19]=a("div",{class:"mt-2 h-1 w-20 rounded-full bg-blue-500"},null,-1)),t(e).errors.judul?(i(),l("p",ps,n(t(e).errors.judul),1)):m("",!0)]),a("div",ms,[s[20]||(s[20]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Instruksi / Deskripsi",-1)),a("div",{class:_(["ck-content-wrapper prose max-w-none",{"rounded-lg ring-1 ring-red-500":t(e).errors.deskripsi}])},[d(t(Ae),{editor:t($e),modelValue:t(e).deskripsi,"onUpdate:modelValue":s[8]||(s[8]=o=>t(e).deskripsi=o),config:V.value},null,8,["editor","modelValue","config"])],2),t(e).errors.deskripsi?(i(),l("p",cs,n(t(e).errors.deskripsi),1)):m("",!0)])])])],32)]))}});export{ws as default};
