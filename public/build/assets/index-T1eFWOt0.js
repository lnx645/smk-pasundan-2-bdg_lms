import{m as F,r as k,u as M,w as T,A as _,K as v,b as i,o as d,e,d as u,g as h,i as o,h as g,z as c,k as p,F as A,j as q,t as n,L as j,f as C,v as E}from"./app-6R2423CB.js";import{l as D}from"./lodash-CvLQx7ah.js";import{_ as K}from"./modal.vue_vue_type_script_setup_true_lang-DWsBOydd.js";import{_ as H}from"./paging.vue_vue_type_script_setup_true_lang-DlDgU27J.js";import{F as S,U as L}from"./upload-BWBF1Y02.js";import{P as G}from"./plus-BT25xviA.js";import{S as X,T as J}from"./trash-2-CVuvbtt_.js";import{P as Q}from"./pencil-BzU3Ty20.js";import{X as R}from"./x-BxVaUl50.js";const W={class:"p-6"},Y={class:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4"},Z={class:"flex gap-2"},ee={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-4"},te={class:"mb-4 relative max-w-sm"},oe={class:"overflow-x-auto"},se={class:"w-full text-left text-sm"},ae={class:"divide-y divide-gray-100"},le={class:"p-3 font-mono font-bold text-indigo-600"},re={class:"p-3 font-medium text-gray-900"},ne={class:"p-3 text-gray-600"},ie={class:"bg-gray-100 px-2 py-1 rounded text-xs border border-gray-200"},de={class:"p-3 text-right"},ue={class:"flex justify-end gap-2"},me=["onClick"],pe=["onClick"],ge={key:0},be={class:"mt-4 border-t pt-4"},xe={class:"p-6"},fe={class:"flex justify-between items-center mb-6"},ce={class:"text-lg font-bold text-gray-900 flex items-center gap-2"},ye={class:"space-y-4"},ke={class:"border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:bg-gray-50 transition relative"},ve={class:"flex flex-col items-center gap-2"},he={key:0,class:"text-sm font-medium text-gray-600"},we={key:1,class:"text-sm font-medium text-emerald-600 break-all"},Me={key:0,class:"bg-red-50 text-red-600 p-3 rounded-lg text-sm flex gap-2 items-center"},_e={class:"mt-8 flex justify-end gap-3"},je=["disabled"],Ce={class:"p-6"},Ke={class:"space-y-4"},Ee={key:0,class:"text-red-500 text-xs mt-1"},Se={key:0,class:"text-red-500 text-xs mt-1"},$e={key:0,class:"text-red-500 text-xs mt-1"},Ne={class:"mt-8 flex justify-end gap-3"},Ve=["disabled"],Ue={class:"p-6"},Pe={class:"space-y-4"},ze={key:0,class:"text-red-500 text-xs mt-1"},Ie={key:0,class:"text-red-500 text-xs mt-1"},Oe={key:0,class:"text-red-500 text-xs mt-1"},Be={class:"mt-8 flex justify-end gap-3"},Fe=["disabled"],Re=F({__name:"index",props:{matpels:Object,filters:Object},setup(y){const w=k(y.filters?.search||""),b=k(!1),x=k(!1),f=k(!1),l=M({kode:"",nama:"",kelompok:""}),a=M({original_kode:"",kode:"",nama:"",kelompok:""}),m=M({file:null});T(w,D.debounce(r=>{_.get(v.index().url,{search:r},{preserveState:!0,replace:!0})},300));const $=()=>{l.reset(),l.clearErrors(),b.value=!0},N=()=>{l.post(v.store().url,{onSuccess:()=>{b.value=!1,l.reset()}})},V=()=>{m.reset(),m.clearErrors(),f.value=!0},U=r=>{const t=r.target;t.files&&t.files[0]&&(m.file=t.files[0])},P=()=>{m.post("/admin/matpel/import",{onSuccess:()=>{f.value=!1,m.reset(),_.reload()},onError:r=>{console.error("Import Gagal",r)}})},z=r=>{r&&(a.clearErrors(),a.reset(),a.original_kode=r.kode,a.kode=r.kode,a.nama=r.nama,a.kelompok=r.kelompok,x.value=!0)},I=()=>{a.original_kode&&a.put(v.update({matpel:a.original_kode}).url,{onSuccess:()=>{x.value=!1,a.reset()}})},O=r=>{confirm("Hapus mata pelajaran ini?")&&_.delete(v.destroy({matpel:r}).url)};return(r,t)=>(d(),i("div",W,[e("div",Y,[t[17]||(t[17]=e("h1",{class:"text-2xl font-bold text-gray-800"},"Data Mata Pelajaran",-1)),e("div",Z,[e("button",{onClick:t[0]||(t[0]=s=>V()),class:"bg-emerald-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-emerald-700 transition shadow-sm text-sm font-medium"},[u(o(S),{size:18}),t[15]||(t[15]=h(" Import Excel ",-1))]),e("button",{onClick:t[1]||(t[1]=s=>$()),class:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-700 transition shadow-sm text-sm font-medium"},[u(o(G),{size:18}),t[16]||(t[16]=h(" Tambah Matpel ",-1))])])]),e("div",ee,[e("div",te,[u(o(X),{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>w.value=s),type:"text",placeholder:"Cari kode atau nama matpel...",class:"pl-10 w-full border border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition"},null,512),[[c,w.value]])]),e("div",oe,[e("table",se,[t[19]||(t[19]=e("thead",{class:"bg-gray-50 border-b border-gray-200 text-gray-600 uppercase text-xs"},[e("tr",null,[e("th",{class:"p-3 font-semibold"},"Kode"),e("th",{class:"p-3 font-semibold"},"Nama Matpel"),e("th",{class:"p-3 font-semibold"},"Kelompok"),e("th",{class:"p-3 text-right font-semibold"},"Aksi")])],-1)),e("tbody",ae,[(d(!0),i(A,null,q(y.matpels.data,s=>(d(),i("tr",{key:s.kode,class:"hover:bg-gray-50 transition-colors"},[e("td",le,n(s.kode),1),e("td",re,n(s.nama),1),e("td",ne,[e("span",ie,n(s.kelompok||"-"),1)]),e("td",de,[e("div",ue,[e("button",{onClick:B=>z(s),class:"p-1.5 rounded-md text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 transition",title:"Edit"},[u(o(Q),{size:18})],8,me),e("button",{onClick:B=>O(s.kode),class:"p-1.5 rounded-md text-gray-400 hover:text-red-600 hover:bg-red-50 transition",title:"Hapus"},[u(o(J),{size:18})],8,pe)])])]))),128)),y.matpels.data.length===0?(d(),i("tr",ge,t[18]||(t[18]=[e("td",{colspan:"4",class:"p-8 text-center text-gray-500 italic"}," Belum ada data mata pelajaran. ",-1)]))):p("",!0)])])]),e("div",be,[u(H,{links:y.matpels.links},null,8,["links"])])]),u(K,{isOpen:f.value,onClose:t[4]||(t[4]=s=>f.value=!1)},{default:j(()=>[e("div",xe,[e("div",fe,[e("h2",ce,[u(o(S),{class:"text-emerald-600"}),t[20]||(t[20]=h(" Import Excel ",-1))])]),e("form",{onSubmit:C(P,["prevent"])},[e("div",ye,[e("div",ke,[e("input",{type:"file",onChange:U,accept:".xlsx, .xls",class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"},null,32),e("div",ve,[u(o(L),{class:"text-gray-400",size:32}),o(m).file?(d(),i("span",we,n(o(m).file.name),1)):(d(),i("span",he," Klik atau tarik file Excel ke sini ")),t[21]||(t[21]=e("span",{class:"text-xs text-gray-400"},"Format: .xlsx, .xls",-1))])]),o(m).errors.file?(d(),i("div",Me,[u(o(R),{size:16}),h(" "+n(o(m).errors.file),1)])):p("",!0)]),e("div",_e,[e("button",{type:"button",onClick:t[3]||(t[3]=s=>f.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition"}," Batal "),e("button",{type:"submit",disabled:o(m).processing,class:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition shadow-sm"},n(o(m).processing?"Mengupload...":"Import Sekarang"),9,je)])],32)])]),_:1},8,["isOpen"]),u(K,{isOpen:b.value,onClose:t[9]||(t[9]=s=>b.value=!1)},{default:j(()=>[e("div",Ce,[t[26]||(t[26]=e("div",{class:"flex justify-between items-center mb-6"},[e("h2",{class:"text-lg font-bold text-gray-900"},"Tambah Mata Pelajaran")],-1)),e("form",{onSubmit:C(N,["prevent"])},[e("div",Ke,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Kode Matpel",-1)),g(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o(l).kode=s),type:"text",class:"w-full border border-gray-300 rounded-lg p-2.5 uppercase focus:ring-indigo-500 focus:border-indigo-500",placeholder:"MTK",required:""},null,512),[[c,o(l).kode]]),o(l).errors.kode?(d(),i("p",Ee,n(o(l).errors.kode),1)):p("",!0)]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nama Matpel",-1)),g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>o(l).nama=s),type:"text",class:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Matematika",required:""},null,512),[[c,o(l).nama]]),o(l).errors.nama?(d(),i("p",Se,n(o(l).errors.nama),1)):p("",!0)]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Kelompok",-1)),g(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>o(l).kelompok=s),class:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-indigo-500 focus:border-indigo-500"},t[24]||(t[24]=[e("option",{value:""},"-- Pilih Kelompok --",-1),e("option",{value:"Muatan Nasional"},"Muatan Nasional",-1),e("option",{value:"Muatan Kewilayahan"},"Muatan Kewilayahan",-1),e("option",{value:"Muatan Kejuruan"},"Muatan Kejuruan",-1)]),512),[[E,o(l).kelompok]]),o(l).errors.kelompok?(d(),i("p",$e,n(o(l).errors.kelompok),1)):p("",!0)])]),e("div",Ne,[e("button",{type:"button",onClick:t[8]||(t[8]=s=>b.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition"}," Batal "),e("button",{type:"submit",disabled:o(l).processing,class:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition shadow-sm"},n(o(l).processing?"Menyimpan...":"Simpan"),9,Ve)])],32)])]),_:1},8,["isOpen"]),u(K,{isOpen:x.value,onClose:t[14]||(t[14]=s=>x.value=!1)},{default:j(()=>[e("div",Ue,[t[31]||(t[31]=e("div",{class:"flex justify-between items-center mb-6"},[e("h2",{class:"text-lg font-bold text-gray-900"},"Edit Mata Pelajaran")],-1)),e("form",{onSubmit:C(I,["prevent"])},[e("div",Pe,[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Kode Matpel",-1)),g(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>o(a).kode=s),type:"text",class:"w-full border border-gray-300 rounded-lg p-2.5 uppercase focus:ring-indigo-500 focus:border-indigo-500",required:""},null,512),[[c,o(a).kode]]),o(a).errors.kode?(d(),i("p",ze,n(o(a).errors.kode),1)):p("",!0)]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nama Matpel",-1)),g(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>o(a).nama=s),type:"text",class:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-indigo-500 focus:border-indigo-500",required:""},null,512),[[c,o(a).nama]]),o(a).errors.nama?(d(),i("p",Ie,n(o(a).errors.nama),1)):p("",!0)]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Kelompok",-1)),g(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>o(a).kelompok=s),class:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-indigo-500 focus:border-indigo-500"},t[29]||(t[29]=[e("option",{value:""},"-- Pilih Kelompok --",-1),e("option",{value:"Muatan Nasional"},"Muatan Nasional",-1),e("option",{value:"Muatan Kewilayahan"},"Muatan Kewilayahan",-1),e("option",{value:"Muatan Kejuruan"},"Muatan Kejuruan",-1)]),512),[[E,o(a).kelompok]]),o(a).errors.kelompok?(d(),i("p",Oe,n(o(a).errors.kelompok),1)):p("",!0)])]),e("div",Be,[e("button",{type:"button",onClick:t[13]||(t[13]=s=>x.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition"}," Batal "),e("button",{type:"submit",disabled:o(a).processing,class:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition shadow-sm"},n(o(a).processing?"Menyimpan...":"Update"),9,Fe)])],32)])]),_:1},8,["isOpen"])]))}});export{Re as default};
