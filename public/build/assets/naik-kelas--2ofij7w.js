import{m as j,r as V,u as P,c as v,w as T,a as o,o as a,d as t,j as x,t as r,g as p,v as _,F as g,i as k,h as n,k as w,I as A,f as N,z as C,A as U}from"./app-CODJwY9m.js";import{K as y}from"./KenaikanKelasController-C4Ft8zOL.js";const I={class:"p-6"},F={class:"mb-4 flex items-center justify-between"},L={key:0,class:"rounded bg-green-100 px-4 py-2 text-sm text-green-800"},B={class:"mb-6 rounded border-l-4 border-blue-500 bg-white p-4 shadow"},D={class:"flex gap-4"},M=["label"],X=["value"],E={key:0,class:"flex flex-col gap-6 md:flex-row"},$={class:"flex-1 rounded bg-white p-4 shadow"},z={class:"mb-2 flex items-center justify-between"},O={class:"rounded bg-blue-100 px-2 py-1 text-xs text-blue-800"},Y={class:"w-full border-collapse text-left"},q={class:"bg-gray-100"},G={class:"border-b border-b-gray-200"},H={class:"w-10 p-2 text-center"},J={class:"p-2 text-center"},Q=["value"],R={class:"p-2 font-mono text-sm"},W={class:"p-2"},Z={class:"p-2 text-sm text-gray-500"},ss={class:"sticky top-4 h-fit w-full rounded border-t-4 border-orange-500 bg-gray-50 p-4 shadow md:w-1/3"},ts={class:"mb-4"},es=["label"],ls=["value"],os={class:"mb-6"},as={key:0,class:"mt-1 text-sm text-red-500"},is={class:"mb-4 rounded bg-blue-100 p-3 text-sm text-blue-800"},ns={class:"font-bold"},ds=["disabled"],rs={key:1,class:"mt-6 rounded bg-white p-10 text-center text-gray-500 shadow"},us={key:2,class:"mt-6 rounded bg-white p-10 text-center text-gray-500 shadow"},gs={__name:"naik-kelas",props:{list_kelas:Array,siswas:Array,selected_kelas_id:String,flash:Object},setup(m){const u=m;j();const c=V(u.selected_kelas_id||""),K=()=>{C.get(y.index().url,{kelas_id:c.value})},l=P({kelas_tujuan_id:"",tingkat_baru:"",nis_list:[]}),h=v({get(){return u.siswas&&u.siswas.length>0?l.nis_list.length===u.siswas.length:!1},set(d){d?l.nis_list=u.siswas.map(s=>s.nis):l.nis_list=[]}});T(()=>l.kelas_tujuan_id,d=>{const s=u.list_kelas.find(e=>e.id==d);s&&(l.tingkat_baru=s.tingkat)});const S=()=>{confirm("Yakin ingin menaikkan kelas siswa yang dipilih?")&&l.post(y.store().url,{onSuccess:()=>{l.reset("nis_list"),U.success("Kenaikan kelas berhasil!")}})},f=v(()=>{const d={};return[...u.list_kelas].sort((e,i)=>e.tingkat-i.tingkat).forEach(e=>{const i=e.tingkat;d[i]||(d[i]=[]),d[i].push(e)}),d});return(d,s)=>(a(),o("div",I,[t("div",F,[s[5]||(s[5]=t("h1",{class:"text-2xl font-bold"},"Proses Kenaikan Kelas",-1)),d.$page.props.flash?.message?(a(),o("div",L,r(d.$page.props.flash.message),1)):x("",!0)]),t("div",B,[s[7]||(s[7]=t("label",{class:"mb-2 block font-semibold"},"Pilih Kelas Asal:",-1)),t("div",D,[p(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),onChange:K,class:"w-full rounded border p-2 md:w-1/3"},[s[6]||(s[6]=t("option",{value:""},"-- Pilih Kelas --",-1)),(a(!0),o(g,null,k(f.value,(e,i)=>(a(),o("optgroup",{key:i,label:"Tingkat "+i},[(a(!0),o(g,null,k(e,b=>(a(),o("option",{key:b.id,value:b.id},r(b.nama),9,X))),128))],8,M))),128))],544),[[_,c.value]])])]),m.siswas.length>0?(a(),o("div",E,[t("div",$,[t("div",z,[s[8]||(s[8]=t("h3",{class:"font-bold"},"Daftar Siswa",-1)),t("span",O,"Terpilih: "+r(n(l).nis_list.length),1)]),t("table",Y,[t("thead",q,[t("tr",G,[t("th",H,[p(t("input",{type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=e=>h.value=e)},null,512),[[w,h.value]])]),s[9]||(s[9]=t("th",{class:"p-2"},"NIS",-1)),s[10]||(s[10]=t("th",{class:"p-2"},"Nama",-1)),s[11]||(s[11]=t("th",{class:"p-2"},"Status",-1))])]),t("tbody",null,[(a(!0),o(g,null,k(m.siswas,e=>(a(),o("tr",{key:e.nis,class:"border-b border-gray-100 hover:bg-gray-50"},[t("td",J,[p(t("input",{type:"checkbox",value:e.nis,"onUpdate:modelValue":s[2]||(s[2]=i=>n(l).nis_list=i)},null,8,Q),[[w,n(l).nis_list]])]),t("td",R,r(e.nis),1),t("td",W,r(e.user?.name??"Nama tidak ditemukan"),1),t("td",Z,r(e.status),1)]))),128))])])]),t("div",ss,[s[17]||(s[17]=t("h3",{class:"mb-4 text-lg font-bold"},"Aksi Kenaikan",-1)),t("div",ts,[s[13]||(s[13]=t("label",{class:"mb-1 block text-sm font-semibold"},"Pindah ke Kelas:",-1)),p(t("select",{"onUpdate:modelValue":s[3]||(s[3]=e=>n(l).kelas_tujuan_id=e),class:"w-full rounded border bg-white p-2"},[s[12]||(s[12]=t("option",{value:""},"-- Pilih Kelas Tujuan --",-1)),(a(!0),o(g,null,k(f.value,(e,i)=>(a(),o("optgroup",{key:i,label:"Tingkat "+i},[(a(!0),o(g,null,k(e,b=>(a(),o("option",{key:b.id,value:b.id},r(b.nama),9,ls))),128))],8,es))),128))],512),[[_,n(l).kelas_tujuan_id]])]),t("div",os,[s[15]||(s[15]=t("label",{class:"mb-1 block text-sm font-semibold"},"Ubah ke Tingkat:",-1)),p(t("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>n(l).tingkat_baru=e),class:"w-full rounded border bg-white p-2"},s[14]||(s[14]=[A('<option value="">-- Pilih Tingkat --</option><option value="10">10 (X)</option><option value="11">11 (XI)</option><option value="12">12 (XII)</option><option value="13">Lulus / Alumni</option>',5)]),512),[[_,n(l).tingkat_baru]]),n(l).errors.tingkat_baru?(a(),o("div",as,r(n(l).errors.tingkat_baru),1)):x("",!0)]),t("div",is,[t("span",ns,r(n(l).nis_list.length),1),s[16]||(s[16]=N(" siswa terpilih akan dipindahkan. ",-1))]),t("button",{onClick:S,disabled:n(l).processing||n(l).nis_list.length===0,class:"w-full rounded bg-blue-600 py-2 font-bold text-white shadow hover:bg-blue-700 disabled:opacity-50"},r(n(l).processing?"Memproses...":"Simpan Perubahan"),9,ds)])])):m.selected_kelas_id?(a(),o("div",rs," Tidak ada siswa aktif di kelas ini. ")):(a(),o("div",us,"Silakan pilih kelas asal terlebih dahulu."))]))}};export{gs as default};
