import{r as u,a0 as C,b as r,o as i,d as g,e,i as b,D as M,Y as S,g as f,k as v,t as c,h as w,z as k,a1 as N,Z as P,L as B,a2 as E,P as j,F as L,$ as h,a3 as y}from"./app-6R2423CB.js";const D={class:"flex min-h-screen flex-col items-center justify-start bg-white pt-10 font-sans"},A={class:"mb-8 flex items-center gap-3"},K=["src"],V={class:"w-full max-w-sm rounded-[20px] bg-[#F5F5F5] p-8 shadow-sm"},I={class:"mb-6"},F={class:"mt-2 text-xs text-gray-500"},J={key:0},U={class:"mb-6"},z=["disabled"],R={key:1},$={class:"mb-6 rounded-2xl border border-gray-200 bg-white p-4 shadow-sm"},T={class:"text-sm font-medium text-gray-800"},q={class:"mb-4"},H={class:"mb-8"},Q={class:"relative"},Y=["type"],Z={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-5 w-5"},G={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-5 w-5"},O={class:"flex flex-col gap-3"},W=["disabled"],X={key:2,class:"mt-4 rounded bg-red-50 p-2 text-center text-xs font-semibold text-red-500"},ee={class:"mt-6 flex justify-center border-t border-gray-300 pt-4"},ae={__name:"reset-password",setup(se){const d=u(1),o=u(!1),a=u(""),x=u(""),p=u(!1),t=C({nis:"",answer:"",new_password:""}),m=async()=>{if(!t.nis){a.value="NIS wajib diisi.";return}o.value=!0,a.value="";try{const l=h.checkNisn().url,s=await y.post(l,{nis:t.nis});x.value=s.data.question,d.value=2}catch(l){a.value=l.response?.data?.message||"NIS tidak ditemukan atau terjadi kesalahan."}finally{o.value=!1}},_=async()=>{if(!t.answer||!t.new_password){a.value="Mohon lengkapi jawaban dan password baru.";return}if(t.new_password.length<6){a.value="Password minimal 6 karakter.";return}o.value=!0,a.value="";try{const l=h.resetPassword().url;await y.post(l,{nis:t.nis,answer:t.answer,new_password:t.new_password}),alert("Sukses! Password berhasil diubah. Silakan login."),window.location.href="/login"}catch(l){a.value=l.response?.data?.message||"Jawaban salah atau gagal mereset."}finally{o.value=!1}};return(l,s)=>(i(),r(L,null,[g(b(M),{title:"Reset Password"}),e("div",D,[e("div",A,[e("img",{src:b(S),alt:"Logo SMK Pasundan 2",class:"h-16 w-auto object-contain"},null,8,K),s[5]||(s[5]=e("div",{class:"flex flex-col leading-tight text-black"},[e("h1",{class:"text-xl font-bold tracking-wide"},[f(" SMK Pasundan "),e("span",{class:"ml-1 text-2xl text-[#C85200]"},"2")]),e("h2",{class:"text-xl font-bold tracking-wide"},"Bandung")],-1))]),e("div",V,[e("div",I,[s[6]||(s[6]=e("h3",{class:"inline-block w-full border-b-2 border-gray-400 pb-2 text-lg font-bold text-black"},"Reset Password",-1)),e("p",F,c(d.value===1?"Masukkan NIS untuk mencari akun Anda.":"Jawab pertanyaan keamanan untuk mereset password."),1)]),d.value===1?(i(),r("div",J,[e("div",U,[s[7]||(s[7]=e("label",{class:"mb-2 block pl-1 text-sm text-black"}," NIS ",-1)),w(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t.nis=n),type:"text",placeholder:"Masukkan NIS",class:"w-full rounded-2xl border-none bg-[#EAEaea] px-5 py-3 text-gray-700 placeholder-gray-400 transition-all focus:ring-2 focus:ring-blue-900 focus:outline-none",onKeyup:N(m,["enter"])},null,544),[[k,t.nis]])]),e("button",{onClick:m,disabled:o.value,class:"w-full rounded-full bg-[#0D1B6E] py-3 text-sm font-bold tracking-wider text-white uppercase shadow-md transition-colors hover:bg-blue-900 disabled:opacity-70"},c(o.value?"Mengecek...":"Lanjut"),9,z)])):d.value===2?(i(),r("div",R,[e("div",$,[s[8]||(s[8]=e("p",{class:"mb-1 text-xs font-bold text-[#C85200] uppercase"},"Pertanyaan Keamanan:",-1)),e("p",T,'"'+c(x.value)+'"',1)]),e("div",q,[s[9]||(s[9]=e("label",{class:"mb-2 block pl-1 text-sm text-black"}," Jawaban Anda ",-1)),w(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>t.answer=n),type:"text",placeholder:"Jawab pertanyaan di atas...",class:"w-full rounded-2xl border-none bg-[#EAEaea] px-5 py-3 text-gray-700 placeholder-gray-400 transition-all focus:ring-2 focus:ring-blue-900 focus:outline-none"},null,512),[[k,t.answer]])]),e("div",H,[s[12]||(s[12]=e("label",{class:"mb-2 block pl-1 text-sm text-black"}," Password Baru ",-1)),e("div",Q,[w(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>t.new_password=n),type:p.value?"text":"password",placeholder:"Minimal 6 karakter",class:"w-full rounded-2xl border-none bg-[#EAEaea] px-5 py-3 text-gray-700 placeholder-gray-400 transition-all focus:ring-2 focus:ring-blue-900 focus:outline-none"},null,8,Y),[[P,t.new_password]]),e("button",{type:"button",onClick:s[3]||(s[3]=n=>p.value=!p.value),class:"absolute inset-y-0 right-0 flex items-center pr-4 text-gray-500 hover:text-gray-700 focus:outline-none"},[p.value?(i(),r("svg",G,s[11]||(s[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"},null,-1)]))):(i(),r("svg",Z,s[10]||(s[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])))])])]),e("div",O,[e("button",{onClick:_,disabled:o.value,class:"w-full rounded-full bg-[#0D1B6E] py-3 text-sm font-bold tracking-wider text-white uppercase shadow-md transition-colors hover:bg-blue-900 disabled:opacity-70"},c(o.value?"Memproses...":"Ubah Password"),9,W),e("button",{onClick:s[4]||(s[4]=n=>d.value=1),class:"text-center text-xs text-gray-500 underline hover:text-[#0D1B6E]"},"Kembali ke Cek NIS")])])):v("",!0),a.value?(i(),r("div",X,c(a.value),1)):v("",!0),e("div",ee,[g(b(j),{href:b(E)().url,class:"text-xs font-bold text-gray-500 transition-colors hover:text-[#0D1B6E]"},{default:B(()=>s[13]||(s[13]=[f(" ‚Üê Kembali ke Halaman Login ",-1)])),_:1,__:[13]},8,["href"])])])])],64))}};export{ae as default};
