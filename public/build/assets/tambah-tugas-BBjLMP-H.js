import{m as C,r as V,u as T,w as g,a3 as _,ak as I,c as B,al as P,C as k,b as o,o as l,e as a,d as n,L as p,g as x,i as t,k as u,n as c,t as i,h as S,z as M,f as E,aP as L}from"./app-6R2423CB.js";import{_ as v}from"./button.vue_vue_type_script_setup_true_lang-Dz5dKsO2.js";import{_ as j}from"./page-title.vue_vue_type_script_setup_true_lang-By9Ku7yv.js";import{A as U,a as z,b as F,B as K,c as A,C as H,d as N,e as $,E as D,f as G,S as J,H as Q,I as R,g as O,h as W,i as q,j as X,k as Y,l as Z,m as ee,n as se,o as te,p as ae,q as re,r as oe,L as le,s as ie,t as ne,u as de,M as ue,v as me,P as pe,w as ce,x as be,T as ge,y as xe,z as fe,D as _e,F as ke,G as ve,J as ye,K as we,U as he,N as Ce,O as Ve,Q as Te,R as Ie,V as Be,W as Pe,X as Se,Y as Me,Z as Ee,_ as Le,a1 as je,$ as Ue,a0 as ze}from"./ckeditor5-BztYqWsi.js";import{l as Fe}from"./lodash-CvLQx7ah.js";import{C as b}from"./vue-select.es-6d7oZifc.js";const Ke={class:"mx-auto max-w-7xl pb-20"},Ae={class:"mb-6 flex flex-col justify-between gap-4 md:flex-row md:items-center"},He={class:"flex items-center gap-3"},Ne={key:0,class:"flex items-center gap-2"},$e={key:1},De={class:"space-y-6 lg:col-span-1"},Ge={class:"rounded-xl border border-neutral-200 bg-white shadow-sm"},Je={class:"space-y-5 p-5"},Qe={key:0,class:"mt-1 text-xs font-medium text-red-500"},Re={class:"mb-3 grid grid-cols-2 rounded-lg bg-neutral-100 p-1"},Oe={key:0},We={key:1},qe={class:"flex flex-col"},Xe={class:"text-sm font-bold"},Ye={class:"text-xs text-gray-500"},Ze={class:"text-xs text-gray-500"},es={class:"text-sm"},ss={key:2,class:"mt-1 text-xs font-medium text-red-500"},ts={class:"rounded-xl border border-neutral-200 bg-white shadow-sm"},as={class:"space-y-5 p-5"},rs={key:0,class:"mt-1 text-xs font-medium text-red-500"},os={key:0,class:"mt-1 text-xs font-medium text-red-500"},ls={class:"space-y-4 lg:col-span-2"},is={class:"rounded-xl border border-neutral-200 bg-white p-6 shadow-sm"},ns={class:"mb-6"},ds={key:0,class:"mt-2 text-sm font-medium text-red-500"},us={class:"relative"},ms={key:0,class:"mt-1 text-xs font-medium text-red-500"},ks=C({__name:"tambah-tugas",setup(ps){const y=["file","text","foto"],m=V([]),e=T({matpel:null,judul:"",deskripsi:"",mode_pengumpulan:"",deadline:"",receiver_type_id:[],receiver_type:"class_id"});g(()=>e.matpel,async d=>{if(!d)return;const s=await _.post(I().url,{matpel_kode:d});m.value=s.data??[],e.reset("receiver_type_id")});const w=B(()=>({licenseKey:"GPL",placeholder:"Tuliskan instruksi tugas secara detail...",height:500,plugins:[U,z,F,K,A,H,N,$,D,G,J,Q,R,O,W,q,X,Y,Z,ee,se,te,ae,re,oe,le,ie,ne,de,ue,me,pe,ce,be,ge,xe,fe,_e,ke,ve,ye,we,he,Ce,Ve,Te,Ie,Be,Pe,Se,Me,Ee,Le],toolbar:["heading","|","bold","italic","underline","strikethrough","code","|","bulletedList","numberedList","todoList","|","fontSize","fontColor","fontBackgroundColor","|","link","insertImage","insertTable","blockQuote","codeBlock","|","undo","redo"]})),h=Fe.debounce(async(d,s)=>{if(!d){s(!1);return}s(!0);try{const{data:r}=await _.get(P().url,{params:{keywords:d}});m.value=r}catch(r){console.error("Gagal mencari siswa:",r)}finally{s(!1)}},500);g(()=>e.receiver_type,()=>{m.value=[]});function f(){e.submit(L())}return g(()=>[e.hasErrors,e.processing],()=>{e.hasErrors&&!e.errors.success&&!e.processing?k.error("Gagal! Mohon periksa kembali inputan Anda."):e.errors.success&&(k.success(e.errors.success),e.resetAndClearErrors(),e.reset())}),(d,s)=>(l(),o("div",Ke,[a("div",Ae,[n(j,{title:"Buat Tugas Baru",subtitle:"Atur detail tugas, target siswa, dan materi pembelajaran."}),a("div",He,[n(v,{variant:"secondary",class:"border border-neutral-300 bg-white text-neutral-600 shadow-sm hover:bg-neutral-50"},{default:p(()=>s[9]||(s[9]=[x(" Batal ",-1)])),_:1,__:[9]}),n(v,{onClick:f,disabled:t(e).processing,class:"shadow-md shadow-blue-500/20"},{default:p(()=>[t(e).processing?(l(),o("span",Ne,s[10]||(s[10]=[a("svg",{class:"h-4 w-4 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),x(" Menyimpan... ",-1)]))):(l(),o("span",$e,"Terbitkan Tugas"))]),_:1},8,["disabled"])])]),a("form",{onSubmit:E(f,["prevent"]),class:"grid grid-cols-1 items-start gap-6 lg:grid-cols-3"},[a("div",De,[a("div",Ge,[s[15]||(s[15]=a("div",{class:"border-b border-neutral-100 bg-neutral-50 px-5 py-3"},[a("h3",{class:"text-sm font-semibold text-neutral-700"},"Target & Mata Pelajaran")],-1)),a("div",Je,[a("div",null,[s[11]||(s[11]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Mata Pelajaran",-1)),n(t(b),{placeholder:"Pilih Mapel...",options:d.$page.props.matpels,label:"nama",reduce:r=>r.kode_matpel,modelValue:t(e).matpel,"onUpdate:modelValue":s[0]||(s[0]=r=>t(e).matpel=r),class:c(["v-select-custom",{"rounded-lg border-red-500 ring-1 ring-red-500":t(e).errors.matpel}])},null,8,["options","reduce","modelValue","class"]),t(e).errors.matpel?(l(),o("p",Qe,i(t(e).errors.matpel),1)):u("",!0)]),s[14]||(s[14]=a("hr",{class:"border-dashed border-neutral-200"},null,-1)),a("div",null,[s[13]||(s[13]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Tugaskan Kepada",-1)),a("div",Re,[a("button",{type:"button",onClick:s[1]||(s[1]=r=>t(e).receiver_type="class_id"),class:c(["rounded-md py-1.5 text-sm font-medium transition-all duration-200",t(e).receiver_type==="class_id"?"bg-white text-blue-600 shadow-sm":"text-neutral-500 hover:text-neutral-700"])}," Per Kelas ",2),a("button",{type:"button",onClick:s[2]||(s[2]=r=>t(e).receiver_type="siswa_id"),class:c(["rounded-md py-1.5 text-sm font-medium transition-all duration-200",t(e).receiver_type==="siswa_id"?"bg-white text-blue-600 shadow-sm":"text-neutral-500 hover:text-neutral-700"])}," Per Siswa ",2)]),t(e).receiver_type=="class_id"?(l(),o("div",Oe,[n(t(b),{placeholder:"Pilih Kelas...",options:m.value,label:"nama_kelas",reduce:r=>r.id_kelas,multiple:!0,modelValue:t(e).receiver_type_id,"onUpdate:modelValue":s[3]||(s[3]=r=>t(e).receiver_type_id=r),class:"v-select-custom"},null,8,["options","reduce","modelValue"])])):(l(),o("div",We,[n(t(b),{class:"v-select-custom",onSearch:t(h),placeholder:"Cari Siswa...",filterable:!1,reduce:r=>r.user.id,options:m.value,multiple:!0,modelValue:t(e).receiver_type_id,"onUpdate:modelValue":s[4]||(s[4]=r=>t(e).receiver_type_id=r)},{"no-options":p(()=>s[12]||(s[12]=[x(" Ketik nama siswa untuk mencari... ",-1)])),option:p(r=>[a("div",qe,[a("span",Xe,i(r.user?.name),1),a("span",Ye,"Kelas: "+i(r.kelas?.nama),1),a("span",Ze,"NIS: "+i(r?.nis),1)])]),"selected-option":p(r=>[a("div",es,i(r.user?.name)+" ["+i(r.kelas?.nama)+"]",1)]),_:1},8,["onSearch","reduce","options","modelValue"])])),t(e).errors.receiver_type_id?(l(),o("p",ss,i(t(e).errors.receiver_type_id),1)):u("",!0)])])]),a("div",ts,[s[18]||(s[18]=a("div",{class:"border-b border-neutral-100 bg-neutral-50 px-5 py-3"},[a("h3",{class:"text-sm font-semibold text-neutral-700"},"Pengumpulan")],-1)),a("div",as,[a("div",null,[s[16]||(s[16]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Batas Waktu (Deadline)",-1)),n(t(je),{formats:{input:"dd.MM.yyyy - HH:mm"},modelValue:t(e).deadline,"onUpdate:modelValue":s[5]||(s[5]=r=>t(e).deadline=r),"auto-apply":"","enable-time-picker":!0,"input-class-name":"dp-custom-input"},null,8,["modelValue"]),t(e).errors.deadline?(l(),o("p",rs,i(t(e).errors.deadline),1)):u("",!0)]),a("div",null,[s[17]||(s[17]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Format Jawaban",-1)),n(t(b),{class:"v-select-custom",modelValue:t(e).mode_pengumpulan,"onUpdate:modelValue":s[6]||(s[6]=r=>t(e).mode_pengumpulan=r),placeholder:"Pilih Format...",options:y},null,8,["modelValue"]),t(e).errors.mode_pengumpulan?(l(),o("p",os,i(t(e).errors.mode_pengumpulan),1)):u("",!0)])])])]),a("div",ls,[a("div",is,[a("div",ns,[S(a("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=r=>t(e).judul=r),placeholder:"Tulis Judul Tugas di sini...",class:"w-full border-none p-0 text-2xl font-bold text-neutral-800 placeholder-neutral-300 focus:ring-0 focus:outline-none"},null,512),[[M,t(e).judul]]),s[19]||(s[19]=a("div",{class:"mt-2 h-1 w-20 rounded-full bg-blue-500"},null,-1)),t(e).errors.judul?(l(),o("p",ds,i(t(e).errors.judul),1)):u("",!0)]),a("div",us,[s[20]||(s[20]=a("label",{class:"mb-2 block text-xs font-semibold tracking-wider text-neutral-500 uppercase"},"Instruksi / Deskripsi",-1)),a("div",{class:c(["ck-content-wrapper prose max-w-none",{"rounded-lg ring-1 ring-red-500":t(e).errors.deskripsi}])},[n(t(ze),{editor:t(Ue),modelValue:t(e).deskripsi,"onUpdate:modelValue":s[8]||(s[8]=r=>t(e).deskripsi=r),config:w.value},null,8,["editor","modelValue","config"])],2),t(e).errors.deskripsi?(l(),o("p",ms,i(t(e).errors.deskripsi),1)):u("",!0)])])])],32)]))}});export{ks as default};
